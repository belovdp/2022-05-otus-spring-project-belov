# 2022-05-otus-spring-belov
Проектная работа

Белов Д.П.

---
## Приложение для продаж
#### Состоять будет из следующих сервисов:
1. Сервис продуктов
2. Сервис заказов
3. Сервис работы с пользователями
4. Сервис по работе с фалами (под вопросом)
5. Eureka
6. Сервис отдающий SPA для админа и для обычных смертых

Всё это будет помещено в docker-compose\
Пользователи будут храниться в keycloak 16.1.1\
Взаимодействие между сервисами будет осуществляться через jwt token\

---
### DONE: Сервис работы с пользователями
Сервис для авторизации и манипуляции с пользователями. \
Все пользователи будут храниться в keycloak 16.1.1, но токен получать и регистрироваться будет через этот сервис.
Доступные роли:
- ADMIN - Роль для работы с админкой. Максимально доступные права
- EDITOR - Роль для работы с админкой. Всё кроме изменения пользователей
- VIEWER - Роль для работы с админкой. Всё только на просмотр
- USER - Роль для пользователей магазина

Возможности:
- Получить токен
- Refresh токена
- Регистрация
- Получить список пользователей (ADMIN, EDITOR, VIEWER)
- Изменить роль пользователей (ADMIN)

---
### Сервис продуктов
Сервис для управления категориями и продуктами. Имеет свою БД pg. Продукты будут простыми, как и категории.

Возможности:
- Создать категорию (ADMIN, EDITOR)
- Изменить категорию (ADMIN, EDITOR)
- Получить список категорий
- Получить список продуктов
- Добавить продукт (ADMIN, EDITOR)
- Изменить продукт (ADMIN, EDITOR)

---
### Сервис заказов
Сервис для оформления заказов. Имеет свою БД pg.\
При оформлении заказа будет обращаться к сервису продуктов, что бы зафиксировать текущую цену и прочее.\
Возможно будет обращаться к сервису пользователей.

Возможности:
- Вывести все заказы (ADMIN, EDITOR, VIEWER)
- Вывести заказы авторизованного клиента (USER)
- Вывести заказы клиента нужного (ADMIN, EDITOR, VIEWER)
- Создать заказ (USER)

---
### Клиентское приложение на Vue
Два варианта: админка и для обычных пользователей

Возможности: все что описано в возможностях бэковых частей

---
### Сервис работы с файлами (под вопросом)
Сервис для добавления картинок к продукту. Имеет свою БД pg.

Возможности:
- Сохранить картинку
- Получить картинку

---
### Вспомогательная информация:
#### Экспорт настроенной конфигурации keycloak
- Прописать volume: `"./keycloak/export.json:/tmp/export.json"`
- Запустить контейнер
- Подключиться к контейнеру
- Выполнить /opt/jboss/keycloak/bin/standalone.sh -Djboss.socket.binding.port-offset=100 -Dkeycloak.migration.action=export -Dkeycloak.migration.provider=singleFile -Dkeycloak.migration.realmName=shop -Dkeycloak.migration.usersExportStrategy=REALM_FILE -Dkeycloak.migration.file=/tmp/export.json